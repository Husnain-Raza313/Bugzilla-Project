
<% environment.context_class.instance_eval { include Rails.application.routes.url_helpers } %>
function changeStatusforBug(){
  var element = document.getElementById("feature_status");
  element.classList.add("status_class");
  var element = document.getElementById("bug_status");
  element.classList.remove("status_class");

}

 function changeStatusforFeature(){
  var element = document.getElementById("bug_status");
  element.classList.add("status_class");
  var element = document.getElementById("feature_status");
  element.classList.remove("status_class");





 }

function checkStatus(){
  link = document.querySelector('#feature_id');
    let check = link.getAttribute('checked');
  console.log(check)
  check== null ? changeStatusforBug() : changeStatusforFeature()

}


$(document).on('turbolinks:load', function() {
  let STATUS = $('#status').val();
  <%# var bugs = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    remote: {
      url: '/bugs/autocomplete?query=%QUERY&&status='+ STATUS,
       wildcard: "%QUERY",
          filter: function(response) {
        console.log(response);
        return response;

      }
    },


  }); %>
  var bugsvalue =[];
$('#bugsss_search').on('input', function() {
      let STATUS = $('#status').val();
      let QUERY = $('#bugs_search').val();
   $.ajax({
      type: "GET",
      contentType: "application/json; charset=utf-8",
      url: "/bugs/autocomplete?query="+QUERY+"&&status="+STATUS,
      corssDomain: true,
      dataType: "json",
      success: function (data) {
        <%#  %>
         console.log(data);
         bugs=data;
      },

      error : function(data) {

      }
   });
 });


<%# $('#bugs_search').typeahead(null, {source: bugsvalue}); %>

$('#bugs_search').typeahead({minLength: 1,
    order: "asc",
    source: function(query, result){

      let STATUS = $('#status').val();
      let QUERY = $('#bugs_search').val();

      $.ajax({
      type: "GET",
      contentType: "application/json; charset=utf-8",
      url: "/bugs/autocomplete?query="+QUERY+"&&status="+STATUS,
      dataType: "json",
      success: function (data) {
         console.log(data);
         bugs=data;
         result($.map(data,function(item){
          return item;
         }));
      },

      error : function(data) {

      }
   });


}});


});

